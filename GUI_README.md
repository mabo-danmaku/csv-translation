# CSV翻訳ツール - GUI版

このドキュメントでは、CSV翻訳ツールのグラフィカルユーザーインターフェース（GUI）版の使用方法について説明します。  
コマンドライン版については、メインの [README.md](README.md) を参照してください。

## 🔹 GUI版の特徴

- 直感的なグラフィカルインターフェースで簡単に操作
- ファイル選択ダイアログでCSVファイルを簡単に指定可能
- ドロップダウンリストから翻訳先言語を選択可能
- リアルタイムで進捗バーが表示され、翻訳の進捗を視覚的に確認
- ログウィンドウで翻訳プロセスの詳細を確認
- 翻訳の中止機能あり
- エンコーディングの自動検出機能と手動選択オプション
- エンコーディング検出ボタンで現在選択されているファイルのエンコーディングを確認可能

## 🚀 GUI版の起動方法

```bash
python csv-translation-gui.py
```

## 📝 GUI版の使い方

### 1️⃣ CSVファイルの選択
「参照...」ボタンをクリックして翻訳したいCSVファイルを選択します。または、ファイルパスを直接入力することもできます。

### 2️⃣ ヘッダー行の設定
CSVファイルにヘッダー行がある場合は、「ヘッダー行あり」チェックボックスをオンにします。

### 3️⃣ エンコーディングの設定
- 「エンコーディング」ドロップダウンリストからCSVファイルのエンコーディングを選択します。
- 「auto」を選択すると自動検出を試みます。
- 「ファイルエンコーディング検出」ボタンをクリックすると、現在選択されているファイルのエンコーディングを検出し表示します。

### 4️⃣ 翻訳する列の指定
- 「列名で指定」または「インデックスで指定」のラジオボタンを選択します。
- 選択した方法に応じて、翻訳する列名または列インデックス（0始まり）を入力します。

### 5️⃣ 翻訳設定
- 「翻訳先言語」ドロップダウンリストから翻訳したい言語を選択します。
- 「ログ間隔」には、進捗状況を更新する間隔（処理する行数）を指定します。

### 6️⃣ 翻訳の実行
「翻訳開始」ボタンをクリックして翻訳を開始します。翻訳の進捗はプログレスバーとログウィンドウに表示されます。

### 7️⃣ 翻訳の中止
翻訳処理を中止したい場合は、「中止」ボタンをクリックします。

### 8️⃣ 翻訳結果
翻訳が完了すると、結果が保存されたファイルのパスがポップアップで表示されます。翻訳結果は元のCSVファイルと同じディレクトリに保存されます。ファイル名には日時が追加されます（例：`output_2025-03-14_12-34-56.csv`）。

## 🖼️ GUI画面の説明

### メイン画面の構成

1. **CSVファイル選択セクション**
   - ファイルパス入力フィールド
   - 参照ボタン
   - ヘッダー行ありチェックボックス

2. **ファイルエンコーディングセクション**
   - エンコーディング選択ドロップダウン
   - 自動検出オプション（「auto」）

3. **翻訳する列の選択セクション**
   - 列名で指定/インデックスで指定ラジオボタン
   - 列名/インデックス入力フィールド

4. **翻訳設定セクション**
   - 翻訳先言語ドロップダウンリスト
   - ログ間隔入力フィールド

5. **実行ボタンセクション**
   - 翻訳開始ボタン
   - 中止ボタン
   - ファイルエンコーディング検出ボタン

6. **進捗表示セクション**
   - プログレスバー

7. **ログ表示セクション**
   - スクロール可能なログウィンドウ

## ⚠ 注意点

- 大きなCSVファイルを処理する場合、翻訳にはある程度の時間がかかる場合があります。その間、アプリケーションは応答を続けています。
- 翻訳中に「中止」ボタンをクリックしても、現在処理中の翻訳リクエストはキャンセルされず、その後の翻訳処理のみが停止します。
- エラーが発生した場合、詳細なエラーメッセージがポップアップで表示されます。
- エンコーディングが不明な場合は「auto」を選択すると、プログラムが自動的に検出を試みます。
- エンコーディングの自動検出が失敗した場合は、「ファイルエンコーディング検出」ボタンを使用してファイルのエンコーディングを確認し、その結果をドロップダウンから手動で選択してください。

## 🔧 トラブルシューティング

| 問題 | 解決方法 |
|------|---------|
| **GUI起動時にエラーが発生する** | Pythonの`tkinter`パッケージがインストールされているか確認してください。 |
| **必須ファイルが見つからないエラー** | `.env`ファイルと`languages.json`ファイルがスクリプトと同じディレクトリに存在するか確認してください。 |
| **DeepL APIキーが設定されていません** | `.env`ファイル内に`DEEPL_AUTH_KEY=your_api_key_here`の形式で有効なAPIキーが設定されているか確認してください。 |
| **CSVファイルを読み込めない** | 「ファイルエンコーディング検出」ボタンを使用して適切なエンコーディングを確認し、選択してください。 |
| **翻訳中にGUIがフリーズする** | 大きなファイルを処理している場合は通常の動作です。処理が完了するまでお待ちください。 |
| **「中止」ボタンをクリックしても即座に止まらない** | 現在処理中の翻訳リクエストが完了した後に停止します。 |
| **言語リストが表示されない** | `languages.json`ファイルがスクリプトと同じディレクトリに存在し、正しい形式であることを確認してください。 |

---

## 📜 ライセンス
このプロジェクトは MIT ライセンスの下で公開されています。

---

## ⚖ 免責事項
このツールは現状のままで提供され、いかなる保証もありません。  
利用に際して発生した問題や損害について、開発者は責任を負いませんので、自己責任でご使用ください。
