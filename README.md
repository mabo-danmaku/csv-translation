# CSV翻訳ツール

このツールは、CSVファイル内の特定の列を [DeepL API](https://www.deepl.com/pro-api) を使用して翻訳する Python スクリプトです。個人利用を目的として作成されました。

## 主な機能

- 指定した列のテキストをDeepL APIで翻訳
- 列の指定方法を「列インデックス番号」または「列名」から選択可能
- 翻訳結果を元の列に上書き
- 翻訳の進捗状況をリアルタイムで表示
- エラー処理および空の値の管理

## 動作環境

- Python 3.6以上
- 必要なPythonパッケージは `requirements.txt` に記載されています。

## インストール方法

1. このリポジトリをクローンまたはダウンロードします。

2. 必要なパッケージをインストールします：

   ```bash
   pip install -r requirements.txt
   ```

3. DeepL APIキーを取得します（[DeepL API](https://www.deepl.com/pro-api) にて無料または有料のアカウントを作成）。

4. プロジェクトディレクトリに `.env` ファイルを作成し、以下のようにAPIキーを設定します：

   ```
   DEEPL_AUTH_KEY=your_api_key_here
   ```

## 使い方

1. スクリプトを実行します：

   ```bash
   python csv-translation.py
   ```

2. 翻訳するCSVファイルのパスを入力します。

3. 列の選択方法を選びます：
   - `1` - 列名（CSVにヘッダー行がある場合）
   - `2` - インデックス番号（0始まり。例: 最初の列は `0`、2番目の列は `1`）

4. 選択した方法に応じて、翻訳する列のインデックス番号または列名を入力します。
   - 例: `ron` の字幕CSVを翻訳する場合、`Dialogue` 列を指定
     - 列名の場合： `Dialogue`
     - インデックス番号の場合： `2`

5. CSVファイルにヘッダー行があるかどうかを確認するメッセージが表示されるので、`y`（はい）または `n`（いいえ）で回答します。

6. 翻訳が完了すると、結果は元のCSVファイルと同じディレクトリに `output.csv` として保存されます。

## 注意点

- 空のセルは翻訳されず、そのまま保持されます。
- 翻訳処理中にエラーが発生した場合、元のテキストが保持されます。
- 大量のデータを翻訳する場合は、DeepL APIの利用制限に注意してください。

## トラブルシューティング

- **「DeepL APIキーが設定されていません」エラー**
  - `.env` ファイルが正しく作成され、有効なAPIキーが含まれていることを確認してください。
- **列が見つからないエラー**
  - CSVファイルの構造を確認し、正しい列名またはインデックスを指定してください。
- **空の値が多い場合**
  - CSVファイルのデータが正しい列に存在しているか確認してください。

## ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。