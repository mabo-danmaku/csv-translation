# CSV翻訳ツール

このツールは、CSVファイル内の特定の列を [DeepL API](https://www.deepl.com/pro-api) を使用して翻訳する Python スクリプトです。  
コマンドライン（CLI）版とグラフィカルユーザーインターフェース（GUI）版の両方が利用可能です。  
個人利用を目的としてAIによって生成され、一部手動で修正・調整を行いました。  
動作の保証はできませんので、ご自身の環境で十分にテストした上でご利用ください。

## 📌 このツールが向いている人
- CSV形式のデータを多言語対応させたい人
- DeepLの高精度な翻訳をスクリプトで活用したい人
- 大量のCSVデータを効率的に翻訳したい人

---

## 🔹 主な機能
- ✅ DeepL APIを利用した高精度な翻訳
- ✅ CSVファイルの特定の列を翻訳し、結果を新しいファイルに保存
- ✅ 列の指定方法は「列名」または「列インデックス」から選択可能
- ✅ 翻訳の進捗状況をリアルタイムで表示
- ✅ エラー処理や空セルの適切な管理
- ✅ コマンドライン（CLI）とグラフィカルインターフェース（GUI）の両方に対応

---

## 💻 動作環境
- **Python 3.6以上**
- 必要なPythonパッケージは `requirements.txt` に記載

---

## 🛠 インストール方法

### 1️⃣ リポジトリのクローンまたはダウンロード
```bash
git clone https://github.com/mabo-danmaku/csv-translation.git
cd csv-translation
```

### 2️⃣ 必要なパッケージのインストール
```bash
pip install -r requirements.txt
```

### 3️⃣ DeepL APIキーの取得と設定
1. [DeepL API](https://www.deepl.com/pro-api) に登録（無料・有料プランあり）
2. APIキーを取得
3. プロジェクトディレクトリに `.env` ファイルを作成し以下のようにAPIキーを設定
```
DEEPL_AUTH_KEY=your_api_key_here
```

---

## 🚀 使い方

### コマンドライン（CLI）版

#### 1️⃣ スクリプトの実行
```bash
python csv-translation.py
```

#### 2️⃣ メニューから操作を選択
```
DeepL翻訳ツール
1: CSVファイルの列を翻訳する
2: 利用可能な言語一覧を表示する
0: 終了
選択してください: 
```

#### 3️⃣ CSVファイルのパスを入力
```
翻訳したいCSVファイルのパスを入力してください: D:\path\to\csv\example.csv
```

#### 4️⃣ CSVのヘッダー有無を指定
```
CSVファイルにヘッダー行がありますか？ (y/n): y
```

#### 5️⃣ 翻訳する列を選択
- 列名で指定 → `1`
- インデックスで指定 → `2`
```
列の指定方法を選択してください（1: 列名, 2: インデックス）: 1
```

#### 6️⃣ 列名またはインデックスを入力

##### 🔹 列名で指定する場合（ヘッダー行があるCSV）
```
翻訳する列名を入力してください: Dialogue
```

##### 🔹 インデックスで指定する場合（0始まり）
```
翻訳する列のインデックスを入力してください（0始まり）: 1
```
（例：CSVの2番目の列を翻訳したい場合、インデックスは `1` ）

#### 7️⃣ 翻訳先の言語を選択
利用可能な言語の一覧が表示されるので、翻訳先の言語コードを入力します。
```
翻訳先の言語コードを入力してください (例: JA): JA
```

#### 8️⃣ 進捗表示の間隔を設定
```
進捗を表示する間隔（行数）を入力してください (例: 10): 10
```

### グラフィカルインターフェース（GUI）版

GUI版を使用したい場合は、以下のコマンドで起動できます：

```bash
python csv-translation-gui.py
```

GUI版の詳細な使用方法については、[GUI版README](GUI_README.md)を参照してください。

---

## 📂 ファイル構成

| ファイル名 | 説明 |
|------------|------|
| csv-translation-v5.py | コマンドライン（CLI）版のメインスクリプト |
| csv-translation-gui-v5.py | グラフィカルインターフェース（GUI）版のスクリプト |
| languages.json | サポートされている言語のリスト |
| .env | DeepL APIキーを保存する環境変数ファイル |
| requirements.txt | 必要なPythonパッケージのリスト |

---

## ⚠ 注意点
- 翻訳結果は、タイムスタンプ付きの新しいCSVファイル（例：`output_2025-03-14_12-34-56.csv`）として保存されます。
- 空のセルは翻訳されず、そのまま保持されます。
- 翻訳処理中にエラーが発生した場合、元のテキストが保持されます。
- **DeepL APIの無料プランでは、1か月あたり50万文字まで翻訳可能**です（2025年現在）。
- 翻訳後は、内容を確認することを推奨します。

---

## ❓ トラブルシューティング

| 問題 | 解決方法 | 
|------|---------|
| **DeepL APIキーが設定されていません** | `.env` ファイルが正しく作成され、有効なAPIキーが含まれているか確認してください。 |
| **指定された列が見つかりません** | CSVファイルの構造を確認し、正しい列名またはインデックスを指定してください。 |
| **空の値が多い場合** | CSVファイルのデータが正しい列に存在しているか確認してください。 |
| **翻訳が途中で止まる** | DeepL APIのリクエスト制限を超えていないか確認してください。 |
| **GUIが応答しなくなる** | 大きなファイルを処理している場合は、処理が完了するまで待つか、または中止ボタンをクリックしてください。 |

---

## 📜 ライセンス
このプロジェクトは MIT ライセンスの下で公開されています。

---

## ⚖ 免責事項
このツールは現状のままで提供され、いかなる保証もありません。  
利用に際して発生した問題や損害について、開発者は責任を負いませんので、自己責任でご使用ください。
