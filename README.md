# CSV翻訳ツール

このツールは、CSVファイル内の特定の列を [DeepL API](https://www.deepl.com/pro-api) を使用して翻訳する Python スクリプトです。  
個人利用を目的としてAIによって生成され、一部手動で修正・調整を行いました。  
動作の保証はできませんので、ご自身の環境で十分にテストした上でご利用ください。

## 主な機能

- DeepL APIを利用した高精度な翻訳
- CSVファイルの指定列を翻訳し、元の列に上書き
- 列の指定方法は「列名」または「列インデックス」から選択可能
- 翻訳の進捗状況をリアルタイムで表示
- エラー処理や空セルの適切な管理

## 動作環境

- Python 3.6以上
- 必要なPythonパッケージは `requirements.txt` に記載されています。

## インストール方法

1. このリポジトリをクローンまたはダウンロードします。

   ```bash
   git clone https://github.com/mabo-danmaku/csv-translation.git
   cd csv-translation
   ```

2. 必要なパッケージをインストールします：

   ```bash
   pip install -r requirements.txt
   ```

3. DeepL APIキーを取得します（[DeepL API](https://www.deepl.com/pro-api) にて無料または有料のアカウントを作成）。

4. プロジェクトディレクトリに `.env` ファイルを作成し、以下のようにAPIキーを設定します：

   ```
   DEEPL_AUTH_KEY=your_api_key_here
   ```

## 使い方

1. スクリプトを実行します：

   ```bash
   python csv-translation.py
   ```

2. 翻訳するCSVファイルのパスを入力します。

3. CSVファイルにヘッダー行があるかどうかを確認するメッセージが表示されるので、`y`（はい）または `n`（いいえ）で回答します。

4. 列の選択方法を選びます：

   - `1` - 列名（CSVにヘッダー行がある場合）
   - `2` - インデックス番号（0始まり。例: 最初の列は `0`、2番目の列は `1`）

5. 選択した方法に応じて、翻訳する列のインデックス番号または列名を入力します。

   - 例：2番目の`Dialogue` 列を指定
     - 列名の場合: `Dialogue`
     - インデックス番号の場合： `1`

6. 翻訳が完了すると、結果は元のCSVファイルと同じディレクトリに `output.csv` として保存されます。

## 注意点

- 空のセルは翻訳されず、そのまま保持されます。
- 翻訳処理中にエラーが発生した場合、元のテキストが保持されます。
- 大量のデータを翻訳する場合は、DeepL APIの利用制限に注意してください。

## トラブルシューティング

| 問題 | 解決方法 | 
|------|---------|
| **「DeepL APIキーが設定されていません」** | `.env` ファイルが正しく作成され、有効なAPIキーが含まれていることを確認してください。 |
| **「指定された列が見つかりません」** | CSVファイルの構造を確認し、正しい列名またはインデックスを指定してください。 |
| **空の値が多い場合** | CSVファイルのデータが正しい列に存在しているか確認してください。 |

## ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。
